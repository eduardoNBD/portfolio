---
import Linkedin from "./icons/Linkedin.astro";
import Mail from "./icons/Mail.astro";
import Phone from "./icons/Phone.astro";  

 
--- 
<div class="grid grid-cols-3 mt-20">
    <section class="col-span-3 sm:col-span-1 mt-0 md:mt-10">
        <div class="mb-4 flex items-center">
            <div class="relative p-[8px] flex pointer icon-contact dark:icon-contact-dark w-12 h-12">
                <b class="bg-[#F3F5F9] dark:bg-[#13151a] w-[44px] h-[44px] absolute top-0.5 left-0.5"/>
                <Phone class="w-[100px] relative text-gray-500 dark:text-gray-200 " /> 
            </div>
            <a href="tel:+523221564984" 
                class="ml-4 font-bold text-gray-800 dark:text-gray-200 
                    border-gray-400 
                    hover:border-[#3363E7]
                    hover:text-[#1e3a8a]">
                322 - 156 - 4984
            </a>
        </div>
        <div class="mb-4 flex items-center">
            <div class="relative p-[8px] flex pointer icon-contact dark:icon-contact-dark w-12 h-12">
                <b class="bg-[#F3F5F9] dark:bg-[#13151a] w-[44px] h-[44px] absolute top-0.5 left-0.5"/>
                <Mail class="w-[120px] relative text-gray-500 dark:text-gray-200 " /> 
            </div>
            <a href="mailto:lalo_elma@hotmail.com" 
                class="ml-4 font-bold text-gray-800 dark:text-gray-200 
                    border-gray-400 
                    hover:border-[#3363E7]
                    hover:text-[#1e3a8a]">
                lalo_elma@hotmail.com
            </a>
        </div>
        <div class="mb-4 flex items-center">
            <div class="relative p-[8px] flex pointer icon-contact dark:icon-contact-dark w-12 h-12">
                <b class="bg-[#F3F5F9] dark:bg-[#13151a] w-[44px] h-[44px] absolute top-0.5 left-0.5"/>
                <Linkedin class="w-[120px] relative text-gray-500 dark:text-gray-200 " /> 
            </div>
            <a href="https://www.linkedin.com/in/eduardo-e/" target="_blank"
                class="ml-4 font-bold text-gray-800 dark:text-gray-200 
                    border-gray-400 
                    hover:border-[#3363E7]
                    hover:text-[#1e3a8a]">
                Eduardo-e
            </a>
        </div> 
    </section>
    <section class="col-span-3 sm:col-span-2">
        <div class="relative bg-[#fafafa] dark:bg-[#17255422] p-8 rounded-lg shadow-lg ">
            <form onsubmit="submitContact()">
                <div class="flex flex-col sm:flex-row ">
                    <div class="px-2 my-2 autocomplete relative mb-5 group flex-grow"> 
                        <input autocomplete="off" type="text" name="name" id="name" class="block py-2.5 px-0 w-full text-sm text-gray-900 dark:text-gray-100  bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-blue-400 peer" placeholder=" " />
                        <label for="name" class="peer-focus:font-medium absolute text-sm text-gray-800 dark:text-gray-200 duration-300 transform -translate-y-6 scale-75 top-3 z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">Nombre</label>
                    </div>
                    <div class="px-2 my-2 autocomplete relative mb-5 group flex-grow"> 
                        <input autocomplete="off" type="text" name="phone" id="phone" class="block py-2.5 px-0 w-full text-sm text-gray-900 dark:text-gray-100  bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-blue-400 peer" placeholder=" " />
                        <label for="phone" class="peer-focus:font-medium absolute text-sm text-gray-800 dark:text-gray-200 duration-300 transform -translate-y-6 scale-75 top-3 z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">Teléfono</label>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row">
                    <div class="px-2 my-2 autocomplete relative mb-5 group flex-grow"> 
                        <input autocomplete="off" type="text" name="email" id="email" class="block py-2.5 px-0 w-full text-sm text-gray-900 dark:text-gray-100  bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-blue-400 peer" placeholder=" " />
                        <label for="email" class="peer-focus:font-medium absolute text-sm text-gray-800 dark:text-gray-200 duration-300 transform -translate-y-6 scale-75 top-3 z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">E-Mail</label>
                    </div>
                    <div class="px-2 my-2 autocomplete relative mb-5 group flex-grow"> 
                        <input autocomplete="off" type="text" name="subject" id="subject" class="block py-2.5 px-0 w-full text-sm text-gray-900 dark:text-gray-100  bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-blue-400 peer" placeholder=" " />
                        <label for="subject" class="peer-focus:font-medium absolute text-sm text-gray-800 dark:text-gray-200 duration-300 transform -translate-y-6 scale-75 top-3 z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">Asunto</label>
                    </div>
                </div> 
                <div class="px-2 my-2 autocomplete relative mb-5 group flex-grow"> 
                    <textarea autocomplete="off" name="message" id="message" class="block py-2.5 px-0 w-full text-sm text-gray-900 dark:text-gray-100  bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-blue-400 peer"/>
                    <label for="message" class="peer-focus:font-medium absolute text-sm text-gray-800 dark:text-gray-200 duration-300 transform -translate-y-6 scale-75 top-3 z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6">Mensaje</label>
                </div>
                <div class="text-center"> 
                    <p id="messageError" class="bg-red-200 text-red-600 mb-5 rounded-lg w-fit px-10 m-auto"></p>
                    <p id="messageSuccess" class="bg-emerald-200 text-emerald-600 mb-5 rounded-lg w-fit px-10 m-auto"></p>
                    <button class="bg-blue-500 px-4 py-2 rounded-lg">Enviar Mensaje</button>
                </div>
            </form>
            <div id="alert" class="hidden mt-4"></div>
        </div>
    </section>
</div>
<script is:inline>
     
    function submitContact() {
        showLoader();
        event.preventDefault();

        const form = event.target;
        const formData = new FormData(form);

        const data = {
            name: formData.get('name'),
            email: formData.get('email'),
            subject: formData.get('subject'),
            message: formData.get('message'),
            phone: formData.get('phone'),
        };

        fetch("/api/sendmail", {
            headers: {
            'Content-Type': 'application/json',
            },
            method: "POST",
            body: JSON.stringify(data),
        })
        .then((res) => res.json())
        .then((json) => {
            hideLoader();
            const alertDiv = document.getElementById('alert');
            alertDiv.classList.remove('hidden');

            if (json.status) {
                alertDiv.innerHTML = `
                    <div class="bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-200 px-4 py-3 rounded relative" role="alert">
                        <strong class="font-bold">¡Éxito!</strong>
                        <span class="block sm:inline"> Mensaje enviado exitosamente.</span>
                    </div>`;
                    setTimeout(() => {
                        alertDiv.innerHTML = ""; 
                        alertDiv.classList.add('hidden');
                    }, "10000");
            } else {
                alertDiv.innerHTML = `
                    <div class="bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded relative" role="alert">
                        <strong class="font-bold">Error</strong>
                        <span class="block sm:inline"> Hubo un error al enviar el mensaje.</span>
                    </div>`;
            }
        })
        .catch((err) => {hideLoader();console.error("error:", err)});
    }

</script>